<!-- Loading Overlay -->
<div class="loading-overlay" *ngIf="isLoading">
  <app-loading size="large" message="Loading your meal plans..."></app-loading>
</div>

<!-- Main Calendar Container -->
<div class="meal-plan-calendar" *ngIf="!isLoading">
  <!-- Header with Navigation -->
  <div class="calendar-header">
    <div class="week-navigation">
      <button mat-icon-button (click)="previousWeek()" matTooltip="Previous Week">
        <mat-icon>chevron_left</mat-icon>
      </button>
      
      <div class="week-range">
        <h2>Week of {{ currentWeek | date:'mediumDate' }}</h2>
        <button mat-button (click)="goToToday()" class="today-btn">
          <mat-icon>today</mat-icon>
          Today
        </button>
      </div>
      
      <button mat-icon-button (click)="nextWeek()" matTooltip="Next Week">
        <mat-icon>chevron_right</mat-icon>
      </button>
    </div>
    
    <!-- Quick Actions -->
    <div class="quick-actions">
      <button mat-raised-button color="primary" (click)="createNewMealPlan()">
        <mat-icon>add</mat-icon>
        New Meal Plan
      </button>
    </div>
  </div>
  
  <!-- Meal Plan Status -->
  <div class="meal-plan-status" *ngIf="activeMealPlan">
    <mat-card class="status-card">
      <mat-card-content>
        <div class="plan-info">
          <h3>{{ activeMealPlan.name }}</h3>
          <p class="plan-description">{{ activeMealPlan.description }}</p>
        </div>
        <div class="nutrition-summary">
          <div class="nutrition-item">
            <span class="value">{{ activeMealPlan.totalNutrition.calories }}</span>
            <span class="label">Cal</span>
          </div>
          <div class="nutrition-item">
            <span class="value">{{ activeMealPlan.totalNutrition.protein }}g</span>
            <span class="label">Protein</span>
          </div>
          <div class="nutrition-item">
            <span class="value">{{ activeMealPlan.totalNutrition.carbs }}g</span>
            <span class="label">Carbs</span>
          </div>
          <div class="nutrition-item">
            <span class="value">{{ activeMealPlan.totalNutrition.fat }}g</span>
            <span class="label">Fat</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Simple Calendar Grid -->
  <div class="calendar-grid">
    <mat-card>
      <mat-card-header>
        <mat-card-title>Weekly Meal Plan</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="week-days" *ngFor="let day of weekDays; let i = index">
          <h3>{{ day | date:'EEEE, MMM d' }}</h3>
          <div class="meals-for-day">
            <div class="meal-slot" *ngFor="let mealType of mealTypes">
              <strong>{{ mealType | titlecase }}:</strong>
              <span class="meal-placeholder">No meal planned</span>
              <button mat-button color="primary" (click)="addMeal(day, mealType)">
                <mat-icon>add</mat-icon>
                Add Meal
              </button>
            </div>
          </div>
          <mat-divider *ngIf="i < weekDays.length - 1"></mat-divider>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!activeMealPlan && !isLoading">
    <div class="empty-content">
      <mat-icon class="empty-icon">event_note</mat-icon>
      <h3>No Meal Plan Active</h3>
      <p>Create your first meal plan to start organizing your weekly meals.</p>
      <button mat-raised-button color="primary" (click)="createNewMealPlan()">
        <mat-icon>add</mat-icon>
        Create Meal Plan
      </button>
    </div>
  </div>
</div>
